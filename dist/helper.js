(()=>{let e="dom_shot_chrome_extension";(t=r||(r={}))[t.ready=0]="ready",t[t.domShot=1]="domShot";var t,r,n,o,i,l={};l=JSON.parse('{"name":"dom-shot-chrome-extension","version":"2.2.7","buildTime":"2024-07-26","source":"src/index.html","description":"dom-shot-chrome-extension","dependencies":{"clsx":"^1.2.1","dayjs":"^1.11.7","html-to-image":"^1.11.11","mobx":"^6.12.3","react":"^18.2.0","react-dom":"^18.2.0","react-draggable":"^4.4.6","react-select":"^5.7.7"},"devDependencies":{"@parcel/transformer-less":"^2.9.3","@types/node":"^20.6.5","@types/react":"18.0","@types/react-dom":"18.0","chrome-types":"^0.1.231","html2canvas":"^1.4.1","parcel":"^2.8.3","postcss":"^8.4.30","postcss-modules":"^4.3.1","process":"^0.11.10"},"scripts":{"start":"parcel src/index.tsx src/popup.html  --no-cache","start:bg":"parcel build src/background.ts --no-cache","build":"rm -rf dist/; parcel build src/background.ts src/helper.ts src/index.tsx src/devtools.html src/sidebar.html --no-content-hash --no-cache;sh deploy.sh","test":"echo \\"Error: no test specified\\" && exit 1"},"repository":{"type":"git","url":"git+https://gitlab.temu.team/dawn.tang/dom-shot-chrome-extension.git"},"keywords":[],"author":"","license":"ISC","bugs":{"url":"https://gitlab.temu.team/dawn.tang/dom-shot-chrome-extension/-/issues"},"homepage":"https://gitlab.temu.team/dawn.tang/dom-shot-chrome-extension"}');let a=(e,...t)=>{console.log("[\uD83D\uDD38DOM_SHOT\uD83D\uDD38]",e,...t)},s=()=>{console.log(`[ğŸ”¸DOM_SHOTğŸ”¸] æ’ä»¶ç‰ˆæœ¬%c v${l.version} at ${l.buildTime}`,"color: orange;")};var c={},u=c={};function h(){throw Error("setTimeout has not been defined")}function d(){throw Error("clearTimeout has not been defined")}function f(e){if(n===setTimeout)return setTimeout(e,0);// if setTimeout wasn't available but was latter defined
if((n===h||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{// when when somebody has screwed with setTimeout but no I.E. maddness
return n(e,0)}catch(t){try{// When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
return n.call(null,e,0)}catch(t){// same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:h}catch(e){n=h}try{o="function"==typeof clearTimeout?clearTimeout:d}catch(e){o=d}}();var m=[],g=!1,p=-1;function w(){g&&i&&(g=!1,i.length?m=i.concat(m):p=-1,m.length&&y())}function y(){if(!g){var e=f(w);g=!0;for(var t=m.length;t;){for(i=m,m=[];++p<t;)i&&i[p].run();p=-1,t=m.length}i=null,g=!1,function(e){if(o===clearTimeout)return clearTimeout(e);// if clearTimeout wasn't available but was latter defined
if((o===d||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{// when when somebody has screwed with setTimeout but no I.E. maddness
o(e)}catch(t){try{// When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
return o.call(null,e)}catch(t){// same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
// Some versions of I.E. have different rules for clearTimeout vs setTimeout
return o.call(this,e)}}}(e)}}// v8 likes predictible objects
function b(e,t){this.fun=e,this.array=t}function v(){}u.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new b(e,t)),1!==m.length||g||f(y)},b.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=v,u.addListener=v,u.once=v,u.off=v,u.removeListener=v,u.removeAllListeners=v,u.emit=v,u.prependListener=v,u.prependOnceListener=v,u.listeners=function(e){return[]},u.binding=function(e){throw Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw Error("process.chdir is not supported")},u.umask=function(){return 0};let E=(()=>{// generate uuid for className of pseudo elements.
// We should not use GUIDs, otherwise pseudo elements sometimes cannot be captured.
let e=0,t=()=>`0000${(1679616*Math.random()<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function x(e){let t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}function S(e,t){let r=e.ownerDocument.defaultView||window,n=r.getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function T(e,t={}){let r=t.width||function(e){let t=S(e,"border-left-width"),r=S(e,"border-right-width");return e.clientWidth+t+r}(e),n=t.height||function(e){let t=S(e,"border-top-width"),r=S(e,"border-bottom-width");return e.clientHeight+t+r}(e);return{width:r,height:n}}function $(e){return new Promise((t,r)=>{let n=new Image;n.decode=()=>t(n),n.onload=()=>t(n),n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function C(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function P(e,t,r){let n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),i=document.createElementNS(n,"foreignObject");return o.setAttribute("width",`${t}`),o.setAttribute("height",`${r}`),o.setAttribute("viewBox",`0 0 ${t} ${r}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),o.appendChild(i),i.appendChild(e),C(o)}let R=(e,t)=>{if(e instanceof t)return!0;let r=Object.getPrototypeOf(e);return null!==r&&(r.constructor.name===t.name||R(r,t))};function L(e,t,r){let n=window.getComputedStyle(e,r),o=n.getPropertyValue("content");if(""===o||"none"===o)return;let i=E();try{t.className=`${t.className} ${i}`}catch(e){return}let l=document.createElement("style");l.appendChild(function(e,t,r){let n=`.${e}:${t}`,o=r.cssText?function(e){let t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}(r):x(r).map(e=>{let t=r.getPropertyValue(e),n=r.getPropertyPriority(e);return`${e}: ${t}${n?" !important":""};`}).join(" ");return document.createTextNode(`${n}{${o}}`)}(i,r,n)),t.appendChild(l)}let D="application/font-woff",A="image/jpeg",k={woff:D,woff2:D,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:A,jpeg:A,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function M(e){let t=(function(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""})(e).toLowerCase();return k[t]||""}function N(e){return -1!==e.search(/^(data:)/)}function I(e,t){return`data:${t};base64,${e}`}async function O(e,t,r){let n=await fetch(e,t);if(404===n.status)throw Error(`Resource "${n.url}" not found`);let o=await n.blob();return new Promise((e,t)=>{let i=new FileReader;i.onerror=t,i.onloadend=()=>{try{e(r({res:n,result:i.result}))}catch(e){t(e)}},i.readAsDataURL(o)})}let H={};async function V(e,t,r){var n,o,i;let l,a;let s=(n=e,o=t,i=r.includeQueryParams,a=n.replace(/\?.*/,""),i&&(a=n),/ttf|otf|eot|woff2?/i.test(a)&&(a=a.replace(/.*\//,"")),o?`[${o}]${a}`:a);if(null!=H[s])return H[s];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());try{let n=await O(e,r.fetchRequestInit,({res:e,result:r})=>(t||(t=e.headers.get("Content-Type")||""),r.split(/,/)[1]));l=I(n,t)}catch(n){l=r.imagePlaceholder||"";let t=`Failed to fetch resource: ${e}`;n&&(t="string"==typeof n?n:n.message),t&&console.warn(t)}return H[s]=l,l}async function _(e){let t=e.toDataURL();return"data:,"===t?e.cloneNode(!1):$(t)}async function F(e,t){if(e.currentSrc){let t=document.createElement("canvas"),r=t.getContext("2d");t.width=e.clientWidth,t.height=e.clientHeight,null==r||r.drawImage(e,0,0,t.width,t.height);let n=t.toDataURL();return $(n)}let r=e.poster,n=M(r),o=await V(r,n,t);return $(o)}async function j(e){var t;try{if(null===(t=null==e?void 0:e.contentDocument)||void 0===t?void 0:t.body)return await B(e.contentDocument.body,{},!0)}catch(e){// Failed to clone iframe
}return e.cloneNode(!1)}async function U(e,t){return R(e,HTMLCanvasElement)?_(e):R(e,HTMLVideoElement)?F(e,t):R(e,HTMLIFrameElement)?j(e):e.cloneNode(!1)}let q=e=>null!=e.tagName&&"SLOT"===e.tagName.toUpperCase();async function z(e,t,r){var n,o;let i=[];return 0===(i=q(e)&&e.assignedNodes?x(e.assignedNodes()):R(e,HTMLIFrameElement)&&(null===(n=e.contentDocument)||void 0===n?void 0:n.body)?x(e.contentDocument.body.childNodes):x((null!==(o=e.shadowRoot)&&void 0!==o?o:e).childNodes)).length||R(e,HTMLVideoElement)||await i.reduce((e,n)=>e.then(()=>B(n,r)).then(e=>{e&&t.appendChild(e)}),Promise.resolve()),t}async function W(e,t){let r=e.querySelectorAll?e.querySelectorAll("use"):[];if(0===r.length)return e;let n={};for(let o=0;o<r.length;o++){let i=r[o],l=i.getAttribute("xlink:href");if(l){let r=e.querySelector(l),o=document.querySelector(l);r||!o||n[l]||(n[l]=await B(o,t,!0))}}let o=Object.values(n);if(o.length){let t="http://www.w3.org/1999/xhtml",r=document.createElementNS(t,"svg");r.setAttribute("xmlns",t),r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.overflow="hidden",r.style.display="none";let n=document.createElementNS(t,"defs");r.appendChild(n);for(let e=0;e<o.length;e++)n.appendChild(o[e]);e.appendChild(r)}return e}async function B(e,t,r){return r||!t.filter||t.filter(e)?Promise.resolve(e).then(e=>U(e,t)).then(r=>z(e,r,t)).then(t=>{var r,n;return r=e,R(n=t,Element)&&(!function(e,t){let r=t.style;if(!r)return;let n=window.getComputedStyle(e);n.cssText?(r.cssText=n.cssText,r.transformOrigin=n.transformOrigin):x(n).forEach(o=>{let i=n.getPropertyValue(o);if("font-size"===o&&i.endsWith("px")){let e=Math.floor(parseFloat(i.substring(0,i.length-2)))-.1;i=`${e}px`}R(e,HTMLIFrameElement)&&"display"===o&&"inline"===i&&(i="block"),"d"===o&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),r.setProperty(o,i,n.getPropertyPriority(o))})}(r,n),L(r,n,":before"),L(r,n,":after"),R(r,HTMLTextAreaElement)&&(n.innerHTML=r.value),R(r,HTMLInputElement)&&n.setAttribute("value",r.value),function(e,t){if(R(e,HTMLSelectElement)){let r=Array.from(t.children).find(t=>e.value===t.getAttribute("value"));r&&r.setAttribute("selected","")}}(r,n)),n}).then(e=>W(e,t)):null}let X=/url\((['"]?)([^'"]+?)\1\)/g,G=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,J=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;async function Q(e,t,r,n,o){try{let i;let l=r?function(e,t){// url is absolute already
if(e.match(/^[a-z]+:\/\//i))return e;// url is absolute already, without protocol
if(e.match(/^\/\//))return window.location.protocol+e;// dataURI, mailto:, tel:, etc.
if(e.match(/^[a-z]+:/i))return e;let r=document.implementation.createHTMLDocument(),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),t&&(n.href=t),o.href=e,o.href}(t,r):t,a=M(t);if(o){let e=await o(l);i=I(e,a)}else i=await V(l,a,n);return e.replace(function(e){// eslint-disable-next-line no-useless-escape
let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}(t),`$1${i}$3`)}catch(e){// pass
}return e}function K(e){return -1!==e.search(X)}async function Y(e,t,r){if(!K(e))return e;let n=function(e,{preferredFontFormat:t}){return t?e.replace(J,e=>{// eslint-disable-next-line no-constant-condition
for(;;){let[r,,n]=G.exec(e)||[];if(!n)return"";if(n===t)return`src: ${r};`}}):e}(e,r),o=function(e){let t=[];return e.replace(X,(e,r,n)=>(t.push(n),e)),t.filter(e=>!N(e))}(n);return o.reduce((e,n)=>e.then(e=>Q(e,n,t,r)),Promise.resolve(n))}async function Z(e,t,r){var n;let o=null===(n=t.style)||void 0===n?void 0:n.getPropertyValue(e);if(o){let n=await Y(o,null,r);return t.style.setProperty(e,n,t.style.getPropertyPriority(e)),!0}return!1}async function ee(e,t){await Z("background",e,t)||await Z("background-image",e,t),await Z("mask",e,t)||await Z("mask-image",e,t)}async function et(e,t){let r=R(e,HTMLImageElement);if(!(r&&!N(e.src))&&!(R(e,SVGImageElement)&&!N(e.href.baseVal)))return;let n=r?e.src:e.href.baseVal,o=await V(n,M(n),t);await new Promise((t,n)=>{e.onload=t,e.onerror=n,e.decode&&(e.decode=t),"lazy"===e.loading&&(e.loading="eager"),r?(e.srcset="",e.src=o):e.href.baseVal=o})}async function er(e,t){let r=x(e.childNodes),n=r.map(e=>en(e,t));await Promise.all(n).then(()=>e)}async function en(e,t){R(e,Element)&&(await ee(e,t),await et(e,t),await er(e,t))}let eo={};async function ei(e){let t=eo[e];if(null!=t)return t;let r=await fetch(e),n=await r.text();return t={url:e,cssText:n},eo[e]=t,t}async function el(e,t){let r=e.cssText,n=/url\(["']?([^"')]+)["']?\)/g,o=r.match(/url\([^)]+\)/g)||[],i=o.map(async o=>{let i=o.replace(n,"$1");return i.startsWith("https://")||(i=new URL(i,e.url).href),O(i,t.fetchRequestInit,({result:e})=>(r=r.replace(o,`url(${e})`),[o,e]))});return Promise.all(i).then(()=>r)}function ea(e){if(null==e)return[];let t=[],r=e.replace(/(\/\*[\s\S]*?\*\/)/gi,""),n=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");// eslint-disable-next-line no-constant-condition
for(;;){let e=n.exec(r);if(null===e)break;t.push(e[0])}r=r.replace(n,"");let o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");// eslint-disable-next-line no-constant-condition
for(;;){let e=o.exec(r);if(null===e){if(null===(e=i.exec(r)))break;o.lastIndex=i.lastIndex}else i.lastIndex=o.lastIndex;t.push(e[0])}return t}async function es(e,t){let r=[],n=[];return(// First loop inlines imports
e.forEach(r=>{if("cssRules"in r)try{x(r.cssRules||[]).forEach((e,o)=>{if(e.type===CSSRule.IMPORT_RULE){let i=o+1,l=e.href,a=ei(l).then(e=>el(e,t)).then(e=>ea(e).forEach(e=>{try{r.insertRule(e,e.startsWith("@import")?i+=1:r.cssRules.length)}catch(t){console.error("Error inserting rule from remote css",{rule:e,error:t})}})).catch(e=>{console.error("Error loading remote css",e.toString())});n.push(a)}})}catch(i){let o=e.find(e=>null==e.href)||document.styleSheets[0];null!=r.href&&n.push(ei(r.href).then(e=>el(e,t)).then(e=>ea(e).forEach(e=>{o.insertRule(e,r.cssRules.length)})).catch(e=>{console.error("Error loading remote stylesheet",e)})),console.error("Error inlining remote css file",i)}}),Promise.all(n).then(()=>(// Second loop parses rules
    e.forEach(e=>{if("cssRules"in e)try{x(e.cssRules||[]).forEach(e=>{r.push(e)})}catch(t){console.error(`Error while reading CSS rules from ${e.href}`,t)}}),r)))}async function ec(e,t){if(null==e.ownerDocument)throw Error("Provided element is not within a Document");let r=x(e.ownerDocument.styleSheets),n=await es(r,t);return n.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>K(e.style.getPropertyValue("src")))}async function eu(e,t){let r=await ec(e,t),n=await Promise.all(r.map(e=>{let r=e.parentStyleSheet?e.parentStyleSheet.href:null;return Y(e.cssText,r,t)}));return n.join("\n")}async function eh(e,t){let r=null!=t.fontEmbedCSS?t.fontEmbedCSS:t.skipFonts?null:await eu(e,t);if(r){let t=document.createElement("style"),n=document.createTextNode(r);t.appendChild(n),e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}}async function ed(e,t={}){let{width:r,height:n}=T(e,t),o=await B(e,t,!0);await eh(o,t),await en(o,t),function(e,t){let{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);let n=t.style;null!=n&&Object.keys(n).forEach(e=>{r[e]=n[e]})}(o,t);let i=await P(o,r,n);return i}async function ef(e,t={}){let{width:r,height:n}=T(e,t),o=await ed(e,t),i=await $(o),l=document.createElement("canvas"),a=l.getContext("2d"),s=t.pixelRatio||function(){let e,t;try{t=c}catch(e){// pass
}let r=t&&t.env?t.env.devicePixelRatio:null;return r&&Number.isNaN(e=parseInt(r,10))&&(e=1),e||window.devicePixelRatio||1}(),u=t.canvasWidth||r,h=t.canvasHeight||n;return l.width=u*s,l.height=h*s,!t.skipAutoScale&&(l.width>16384||l.height>16384)&&(l.width>16384&&l.height>16384?l.width>l.height?(l.height*=16384/l.width,l.width=16384):(l.width*=16384/l.height,l.height=16384):l.width>16384?(l.height*=16384/l.width,l.width=16384):(l.width*=16384/l.height,l.height=16384)),l.style.width=`${u}`,l.style.height=`${h}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,l.width,l.height)),a.drawImage(i,0,0,l.width,l.height),l}async function em(e,t={}){let r=await ef(e,t);return r.toDataURL()}let eg=()=>{a("ç”Ÿæˆæˆªå›¾ä¸­ï¼Œè¯·åœ¨å³ä¾§æŸ¥çœ‹");let t=window.DOM_SHOT_EXT_DOM||null;t&&em(t,{backgroundColor:"transparent"}).then(t=>{window.postMessage({source:e,action:r.domShot,payload:t},"*")}).catch(console.error)},ep="dom_shot_ext_helper";if(window[ep])window[ep].init();else{let t=new class{constructor(e){this.clearEvent=()=>{},this.init=async()=>{this.clearEvent(),this.initUtils()},s(),this.tabId=e||0}initUtils(){let t=async t=>{if(console.log("[dodo] ","event",t),t?.data?.source!==e)return;let{action:r}=t.data||{};this.utilsActionMap[r]?.()};this.clearEvent=()=>{window.removeEventListener("message",t),window.removeEventListener("beforeunload",this.clearEvent)},window.addEventListener("message",t),window.addEventListener("beforeunload",this.clearEvent)}get utilsActionMap(){return{/** ç»™ DOM æˆªå›¾ï¼Œä¿ç•™é€æ˜è‰² */[r.domShot]:eg}}}(...window[e]?.args||[]);window[ep]=t,t.init()}})();//# sourceMappingURL=helper.js.map

//# sourceMappingURL=helper.js.map
